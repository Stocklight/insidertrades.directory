<%# SEO meta tags %>
<% content_for(:title, "#{@post.title} - InsiderTrades.directory") %>
<% content_for(:meta_description, @post.summary) %>

<div class="container py-4">
  <div class="row">
    <div class="col-lg-8">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><%= link_to "Home", root_path, class: "text-decoration-none" %></li>
          <li class="breadcrumb-item"><%= link_to "Built with Rails", built_with_rails_path, class: "text-decoration-none" %></li>
          <li class="breadcrumb-item active" aria-current="page"><%= @post.title %></li>
        </ol>
      </nav>
      
      <article class="mb-5">
        <header class="mb-4">
          <div class="d-flex align-items-center mb-3">
            <span class="badge bg-primary me-2"><%= @post.read_time %></span>
            <small class="text-muted">Published <%= Date.current.strftime("%B %d, %Y") %></small>
            <% unless @post.published? %>
              <span class="badge bg-warning text-dark ms-2">Draft</span>
            <% end %>
          </div>
          
          <h1 class="display-5 fw-bold mb-3"><%= @post.title %></h1>
          <p class="lead text-muted"><%= @post.summary %></p>
        </header>
        
        <%# Video embed section %>
        <% if @post.youtube_slug.present? %>
          <div class="mb-5">
            <h2 class="h4 mb-3">📹 Watch the Development Process</h2>
            <div class="ratio ratio-16x9">
              <iframe 
                src="https://www.youtube.com/embed/<%= @post.youtube_slug %>?si=pOkU4qezTikJh66x" 
                title="<%= @post.title %> - Development Process"
                allowfullscreen>
              </iframe>
            </div>
            <p class="small text-muted mt-2">
              <em>What the whole video at: <%= link_to "youtube.com/watch?v=#{@post.youtube_slug}", "https://www.youtube.com/watch?v=#{@post.youtube_slug}" %></em>
            </p>
          </div>
        <% end %>
        
        <div class="content">
          <%= render "blog/#{@post.slug}" %>
        </div>
      </article>
    </div>
    
    <div class="col-lg-4">
      <div class="sticky-top" style="top: 2rem;">
        <div class="card">
          <div class="card-header">
            <h5 class="card-title mb-0">Related Posts</h5>
          </div>
          <div class="card-body">
            <div class="list-group list-group-flush">
              <div class="list-group-item px-2 py-2 bg-light">
                <small class="text-muted"><%= @post.published_date&.strftime("%b %d, %Y") %></small><br>
                <span class="small fw-bold"><%= @post.title %></span>
              </div>
              <% @related_posts.each do |related_post| %>
                <div class="list-group-item px-2 py-2">
                  <small class="text-muted">
                    <%= related_post.published? ? related_post.published_date&.strftime("%b %d, %Y") : "Coming Soon" %>
                  </small><br>
                  <% if related_post.published? %>
                    <%= link_to related_post.title, built_with_rails_post_path(related_post), class: "small text-decoration-none" %>
                  <% else %>
                    <span class="small text-muted"><%= related_post.title %></span>
                  <% end %>
                </div>
              <% end %>
            </div>
            <%= link_to "← Back to All Posts", built_with_rails_path, class: "btn btn-outline-primary btn-sm mt-3" %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
